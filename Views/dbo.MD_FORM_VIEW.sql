SET QUOTED_IDENTIFIER, ANSI_NULLS ON
GO


/* 07/27/2015 ADDED HCD for Aug 2015 Proofs  */

CREATE VIEW [dbo].[MD_FORM_VIEW] as
select MD.NEW,
MD.UID,
MD.BREED,
MD.COUNTRY,
MD.IDNO,
MD.CODENO,
MD.D,
MD.REGNAME,
MD.RECESS,
MD.CODENAME,
MD.DOB,
MD.SOURCE,
MD.NDTRS,
MD.NHRDS,
MD.PTAM,
MD.PTAF_P,
MD.PTAF,
MD.PTAP_P,
MD.PTAP,
MD.REL_YLD,
MD.REL_MF,
MD.PREL,
MD.NM,
MD.REL_NM,
MD.PL,
MD.REL_PL,
MD.SCS,
MD.REL_SCS,
MD.MILK,
MD.FAT_P,
MD.FAT,
MD.PROTM,
MD.PRO_P,
MD.PRO,
MD.DPR,
MD.REL_DPR,
MD.DPR_DTRS,
MD.HCR,
MD.REL_HCR,
MD.HCR_DTRS,
MD.CCR,
MD.REL_CCR,
MD.CCR_DTRS,
MD.SAMPLE,
MD.STATUS,
MD.TPI,
MD.TDATE,
MD.TSOURCE,
MD.TDTRS,
MD.THRDS,
MD.PTAT,
MD.TREL,
MD.UDC,
MD.FLC,
MD.MOB,
MD.REL_MOB,
MD.MOB_HRDS,
MD.MOB_DTRS,
MD.BDC,
MD.DC,
MD.KC,
MD.BLG,
MD.BCN,
MD.CVM,
MD.IBR,
MD.LEU,
MD.BT,
MD.EHD,
MD.JOHNES,
MD.UDT,
MD.PEDIGREE,
MD.BLACK_PCT,
MD.IND,
MD.RELDATE,
MD.LDTRS,
MD.LHRDS,
MD.STAT,
MD.STR,
MD.BD,
MD.DF,
MD.RA,
MD.THURLW,
MD.RLS,
MD.RLR,
MD.FA,
MD.FLS,
MD.FUA,
MD.RUH,
MD.RUW,
MD.UC,
MD.UD,
MD.FTP,
MD.RTP,
MD.TEATL,
MD.CEDATE,
MD.CE_G_IND,
MD.SCE,
MD.PRELIM,
MD.SCE_OBS,
MD.SCE_REL,
MD.DCE,
MD.DCE_OBS,
MD.DCE_REL,
MD.SSB_OBS,
MD.SSB_HERDS,
MD.SSB_REL,
MD.SSB_PCT,
MD.SSB_SOURCE,
MD.SSB_OFF,
MD.DSB_OBS,
MD.DSB_DTRS,
MD.DSB_HERDS,
MD.DSB_REL,
MD.DSB_PCT,
MD.DSB_SOURCE,
MD.DSB_OFF,
MD.MS,
MD.REL_MS,
MD.DIS,
MD.AAA,
MD.DMS,
MD.SCR,
MD.SERV_SCR,
MD.REL_SCR,
MD.G_IND,
MD.EVALDATE,
MD.KEYY,
MD.RHAIND,
MD.HBSTATUS,
MD.SBREED,
MD.SCOUNTRY,
MD.SIDNO,
MD.SIRE,
MD.SREGNAME,
MD.DBREED,
MD.DCOUNTRY,
MD.DIDNO,
MD.DREGNAME,
MD.MGSBREED,
MD.MGSCOUNTRY,
MD.MGSIDNO,
MD.OBREED,
MD.OCOUNTRY,
MD.OIDNO,
MD.NAABCODE2,
MD.NAABCODE3,
MD.NAABCODE4,
MD.NAABCODE5,
MD.NAABCODE6,
MD.RUSSIA,
MD.S1,
MD.S2,
MD.S3,
MD.S4,
MD.S5,
MD.S6,
MD.S7,
MD.S8,
MD.UKLIST,
MD.BIRTH_STATE,
MD.BREED_EVAL,
MD.FTI,
MD.FUI,
MD.NM_PCTILE,
MD.QTYCNTRY,
MD.MDCNTRY,
MD.PCT_US,
MD.PA_MILK,
MD.PA_FAT,
MD.PA_PRO,
MD.REL_MF_PA,
MD.PA_PL,
MD.REL_PL_PA,
MD.PA_SCS,
MD.REL_SCS_PA,
MD.PA_DPR,
MD.REL_DPR_PA,
MD.PA_NM,
MD.REL_NM_PA,
MD.TREL_PA,
MD.PTAT_PA,
MD.STAT_PA,
MD.STR_PA,
MD.BD_PA,
MD.DF_PA,
MD.RA_PA,
MD.THURLW_PA,
MD.RLS_PA,
MD.RLR_PA,
MD.FA_PA,
MD.FLS_PA,
MD.FUA_PA,
MD.RUH_PA,
MD.RUW_PA,
MD.UC_PA,
MD.UD_PA,
MD.FTP_PA,
MD.RTP_PA,
MD.TEATL_PA,
MD.UDC_PA,
MD.FLC_PA,
MD.BDC_PA,
MD.DC_PA,
MD.PA_TPI,
MD.INBRED_PCT,
MD.INBRED_DTR,
MD.INBRED_EFI,
MD.STUD,
MD.PA_HCR,
MD.REL_PA_HCR,
MD.PA_CCR,
MD.REL_PA_CCR,
MD.BREEDSORT,
MD.LOCATION,
MD.SAUDI,
MD.IRAN,
MD.RSA,
MD.ITALYLIST,
MD.AUSTRALIA,
MD.UID2,
MD.PKEY,
MD.TKEY,
MD.YS,
MD.ACE_SERV,
MD.ACE,
MD.ACE_STAR,
MD.CFI_SERV,
MD.CFI,
MD.ATA_SERV,
MD.ATA_SSFS,
MD.ATA_STAR,
MD.CHIPTYPE,
MD.INBRED_PCT_GEN,
MD.GFI,
MD.MKTG_PEDIGREE,
MD.HEIGHT,
MD.CM_DOL,
MD.FM_DOL,
MD.GM_DOL,
MD.FE,
MD.FI,
MD.SEXED_ONLY,
case when SUBSTRING(MD.[UID],1,2) = 'AY' THEN CONCAT('AH1 = ',AH1) 
WHEN SUBSTRING(MD.[UID],1,2) = 'BS'  THEN CONCAT('BH1 = ',BH1,', BH2 = ',BH2,', BHD = ',BHD,', BHM = ',BHM,', BHW = ',BHW,', BHP = ',BHP)
WHEN SUBSTRING(MD.[UID],1,2) = 'JE' THEN CONCAT('JH1 = ',JH1, ', JH1_PC = ',JH1_PC,', JH2 = ',JH2,', JH2_PC = ',JH2_PC,', JHP = ',JHP,', JHP_PC = ',JHP_PC) 
WHEN SUBSTRING(MD.[UID],1,2) = 'HO' THEN 
CONCAT('HH0 = ',HH0, ', HH1 = ',HH1, ', HH2 = ',HH2, ', HH3 = ',HH3, ', HH4 = ',HH4, ', HH5 = ',HH5, ', HHB = ',HHB, ', HHC = ',HHC, ', HHD = ',HHD, ', HHM = ',HHM, ', HHP = ',HHP, ', HHR = ',HHR, 
', HDR = ',HDR, ', HBR = ',HBR,', HCD = ',HCD)
 ELSE '' END AS HAPDATA FROM Megadairy MD left outer join HaplotypeData HD on MD.uid = HD.UID;
GO