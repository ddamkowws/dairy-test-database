SET QUOTED_IDENTIFIER, ANSI_NULLS ON
GO

CREATE VIEW [dbo].[proof_data] AS
SELECT DISTINCT M.G_IND
, M.BREED
, M.COUNTRY
, M.IDNO
, M.UID
, M.CODENO
, M.REGNAME
, M.CODENAME
, M.DOB
, M.SREGNAME
, M.SOURCE
, M.NDTRS
, M.NHRDS
, M.PTAM
, M.PTAF_P
, M.PTAF
, M.PTAP_P
, M.PTAP
, M.REL_YLD
, M.REL_MF
, M.PREL
, M.NM
, M.REL_NM
, M.PL
, M.REL_PL
, M.SCS
, M.REL_SCS
, M.MILK
, M.FAT_P
, M.FAT
, M.PROTM
, M.PRO_P
, M.PRO
, M.DPR
, M.REL_DPR
, M.SAMPLE
, M.STATUS
, M.TPI
, M.TDATE
, M.TSOURCE
, M.TDTRS
, M.THRDS
, M.PTAT
, M.TREL
, M.UDC
, Round(M.FLC,2) AS FLC
, M.MOB
, M.REL_MOB
, M.BDC
, M.DC
, M.PEDIGREE
, M.DREGNAME
, M.BCN
, M.BLG
, M.KC
, M.INBRED_PCT
, M.INBRED_DTR
, M.INBRED_EFI
, M.BLACK_PCT
, M.IND
, M.LDTRS
, M.LHRDS
, M.STAT
, M.Str
, M.BD
, M.DF
, M.RA
, M.THURLW
, M.RLS
, M.RLR
, M.FA
, M.FLS
, M.FUA
, M.RUH
, M.RUW
, M.UC
, M.UD
, M.FTP
, M.RTP
, M.TEATL
, M.CEDATE
, M.SCE
, M.PRELIM
, M.SCE_OBS
, M.SCE_REL
, M.DCE
, M.DCE_OBS
, M.DCE_REL
, M.SSB_OBS
, M.SSB_HERDS
, M.SSB_REL
, M.SSB_PCT
, M.SSB_SOURCE
, M.SSB_OFF
, M.DSB_OBS
, M.DSB_DTRS
, M.DSB_HERDS
, M.DSB_REL
, M.DSB_PCT
, M.DSB_SOURCE
, M.DSB_OFF
, M.MS
, M.REL_MS
, M.DIS
, M.AAA
, M.DMS
, M.SCR
, M.SERV_SCR
, M.REL_SCR
, M.SIRE
, M.EVALDATE
, M.RHAIND
, M.HBSTATUS
, M.SBREED
, M.SCOUNTRY
, M.SIDNO
, M.DBREED
, M.DCOUNTRY
, M.DIDNO
, M.MGSBREED
, M.MGSCOUNTRY
, M.MGSIDNO
, M.OBREED
, M.OCOUNTRY
, M.OIDNO
, M.NAABCODE2
, M.NAABCODE3
, M.NAABCODE4
, M.NAABCODE5
, M.NAABCODE6
, M.breed_eval
, Round(M.FTI,3) AS FTI
, Round(M.FUI,2) AS FUI
, M.NM_PCTILE
, M.PCT_US
, CE.SCE_SOURCE
, CE.DCE_SOURCE
, M.PKEY
, M.TKEY
, M.YS
, M.STUD
, M.CM_DOL
, M.FM_DOL
, M.GM_DOL
, M.HCR
, M.REL_HCR
, M.HCR_DTRS
, M.CCR
, M.REL_CCR
, M.CCR_DTRS
, M.FE
, M.FI
, W.MAST 
, W.LAME
, W.MET
, W.RP
, W.KET
, W.DA
, W.MAST_REL
, W.LAME_REL
, W.MET_REL
, W.RP_REL 
, W.KET_REL
, W.DA_REL
, W.MAST_DAU
, W.LAME_DAU
, W.MET_DAU
, W.RP_DAU
, W.KET_DAU
, W.DA_DAU
, W.WT AS WT
, W.DWP
, W.HP
, HD.HH0
, HD.HH1
, HD.HH2
, HD.HH3
, HD.HH4
, HD.HH5
, HD.HHB
, HD.HHC
, HD.HHD
, HD.HHM
, HD.HHP
, HD.HHR
, HD.HDR
, HD.HBR
, HD.HCD
, HD.JH1
, HD.JH1_PC
, HD.JH2
, HD.JH2_PC
, HD.JHP
, HD.JHP_PC
, HD.BH1
, HD.BH2
, HD.BHD
, HD.BHM
, HD.BHW
, HD.BHP
, HD.AH1
FROM [Dairy].[dbo].[Megadairy] M 
LEFT OUTER JOIN [Dairy].[dbo].[WELLNESS] W ON W.UID = M.UID 
LEFT OUTER JOIN [Dairy].[dbo].[HaplotypeData] HD on M.UID = HD.UID
LEFT OUTER JOIN CE ON M.UID = CE.UID
WHERE (M.BREED <> 'BS' and M.STAT is not null) or (M.BREED = 'BS' AND M.MOB IS NOT NULL)
GO